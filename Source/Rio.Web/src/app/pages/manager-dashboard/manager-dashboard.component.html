<div class="container mt-sm-4" *ngIf="currentUser">


  <div class="row">
    <div class="col-sm-6">
      <h2 style="display: inline-block;">
        Manager Dashboard
      </h2>
    </div>
    <div class="col-sm-6 text-right">
      <a class="btn btn-rio btn-sm" routerLink="/parcels/bulk-set-allocation">Set Allocation for All
        Parcels</a>
        <div class="float-right pl-2">
      <rio-water-year-select [years]="waterYears" [(selectedYear)]="waterYearToDisplay"
        (selectedYearChange)="updateAnnualData()"></rio-water-year-select></div>
    </div>
  </div>


  <app-alert-display></app-alert-display>

  <div class="row mt-4">
    <div class="col-sm-12">
      <div class="card">
        <div class="card-header">
          <div class="float-right">
            <label class="switch">
              <input type="checkbox" (change)="toggleUnitsShown()" />
              <div class="slider round">
                <span class="off">ac-ft</span>
                <span class="on">ac-ft/ac</span>
              </div>
            </label>
          </div>
          District-Wide Statistics
        </div>
        <div class="card-body" *ngIf="parcelAllocationAndUsages">
          <div class="row">
            <div class="col-sm-3 text-sm-left">
              <strong>Total Allocation</strong>
            </div>
            <div class="col-sm-3 text-sm-right">
              {{getAnnualAllocation() | number: '1.1-1'}} {{unitsShown}}
            </div>
            <div class="col-sm-3 text-sm-left">
              <strong>Total Usage</strong>
            </div>
            <div class="col-sm-3 text-sm-right">
              {{getAnnualUsage() | number: '1.1-1'}} {{unitsShown}}
            </div>
          </div>
          <div class="row">
            <div class="col-sm-3 text-sm-left">
              <strong>Total Native Yield</strong>
            </div>
            <div class="col-sm-3 text-sm-right">
              {{getAnnualNativeYield() | number: '1.1-1'}} {{unitsShown}}
            </div>
            <div class="col-sm-3 text-sm-left">
              <strong>Total Project Water</strong>
            </div>
            <div class="col-sm-3 text-sm-right">
              {{getAnnualProjectWater() | number: '1.1-1'}} {{unitsShown}}
            </div>
          </div>
          <div class="row">
            <div class="col-sm-3 text-sm-left">
              <strong>Total Reconciliation Water</strong>
            </div>
            <div class="col-sm-3 text-sm-right">
              {{getAnnualReconciliation() | number: '1.1-1'}} {{unitsShown}}
            </div>
            <div class="col-sm-3 text-sm-left">
              <strong>Total Stored Water</strong>
            </div>
            <div class="col-sm-3 text-sm-right">
              {{getAnnualStoredWater() | number: '1.1-1'}} {{unitsShown}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4">
    <div class="col-sm-12" *ngIf="parcels">
      <div class="card">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-7">
              Landowner Usage Report
            </div>
            <div class="col-sm-5">
              <a class="float-right btn btn-secondary btn-sm" style="cursor: pointer;"
                (click)="exportLandOwnerUsageReportToCsv()"><i class="fas fa-download"></i></a>
            </div>
          </div>
        </div>
        <div class="card-body table-responsive">
          <ag-grid-angular #landOwnerUsageReportGrid style="width: 100%; height: 300px;" class="ag-theme-balham"
            [rowData]="landownerUsageReports" [columnDefs]="landownerUsageReportGridColumnDefs" [pagination]="true"
            [paginationPageSize]="100">
          </ag-grid-angular>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4" *ngIf="allowTrading()">
    <div class="col-sm-12" *ngIf="parcels">
      <div class="card">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-7">
              Trade Activity
            </div>
            <div class="col-sm-5">
              <a class="float-right btn btn-secondary btn-sm" style="cursor: pointer;"
                (click)="exportTradeActivityToCsv()"><i class="fas fa-download"></i></a>
            </div>
          </div>
        </div>
        <div class="card-body table-responsive">
          <ag-grid-angular #tradeActivityGrid style="width: 100%; height: 300px;" class="ag-theme-balham"
            [rowData]="trades" [columnDefs]="tradesGridColumnDefs" [pagination]="true" [paginationPageSize]="100">
          </ag-grid-angular>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4">
    <div class="col-sm-12" *ngIf="parcels">
      <div class="card">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-7">
              Postings
            </div>
            <div class="col-sm-5">
              <a class="float-right btn btn-secondary btn-sm" style="cursor: pointer;"
                (click)="exportPostingsToCsv()"><i class="fas fa-download"></i></a>
            </div>
          </div>
        </div>
        <div class="card-body table-responsive">
          <ag-grid-angular #postingsGrid style="width: 100%; height: 300px;" class="ag-theme-balham"
            [rowData]="postings" [columnDefs]="postingsGridColumnDefs" [pagination]="true" [paginationPageSize]="100">
          </ag-grid-angular>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-sm-4" *ngIf="parcels">
    <div class="col-sm-12">
      <div class="card">
        <div class="card-header">
          Parcels
        </div>
        <div class="card-body table-responsive">
          <parcel-map mapID="parcelsMap" [selectedParcelIDs]="getSelectedParcelIDs()" mapHeight="600px">
          </parcel-map>
        </div>
      </div>
    </div>
  </div>
</div>