<div class="container mt-sm-4" *ngIf="account">
    <div class="float-right pr-0">
        <div class="row">
          <div class="col-md-12" >
            <rio-water-year-select [years]="waterYears" [(selectedYear)]="waterYearToDisplay"
              (selectedYearChange)="updateAnnualData()" [(disabled)]="isEditing"></rio-water-year-select>
          </div>
        </div>
      </div>
    <h2>
        Override ET Data for - {{account.AccountDisplayName}} - {{waterYearToDisplay}}
    </h2>
    <app-alert-display></app-alert-display>

    <div class="row mt-4" *ngIf="parcels && parcels.length > 0">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-header">
                    <div class="float-right">
                        <button class="btn btn-rio" [(disabled)]="isEditing" (click)="toggleEditMode()">Edit</button>
                    </div>
                    {{waterYearToDisplay}} Water Usage by Parcel
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-condensed">
                            <thead>
                                <tr>
                                    <th>Parcel Number</th>
                                    <th *ngFor="let month of months">{{month}}</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let parcel of parcels">
                                    <td class="text-nowrap"><a routerLink="/parcels/{{parcel.ParcelID}}">{{parcel.ParcelNumber}}</a></td>
                                    <td class="text-right" [ngClass]="parcelMonthlyEvaporation.OverriddenEvapotranspirationRate != null && !isEditing ? 'font-italic' : ''" *ngFor="let parcelMonthlyEvaporation of getParcelEvaporationMonthlyData(parcel)">
                                        <span *ngIf="parcelMonthlyEvaporation.OverriddenEvapotranspirationRate != null && !isEditing">*</span>
                                        {{ parcelMonthlyEvaporation.IsEmpty ? "-" : (!isEditing && parcelMonthlyEvaporation.OverriddenEvapotranspirationRate ? parcelMonthlyEvaporation.OverriddenEvapotranspirationRate : parcelMonthlyEvaporation.EvapotranspirationRate) | number:"1.1-1"}} 
                                        <br>
                                        <input type="number" [(ngModel)]="parcelMonthlyEvaporation.OverriddenEvapotranspirationRate" style="width:50px; text-align:right" *ngIf="isEditing && (waterYearToDisplay < currentYear || (waterYearToDisplay == currentYear && parcelMonthlyEvaporation.WaterMonth <= currentMonth))" (keypress)="catchExtraSymbols($event)" (paste)="catchPastedSymbols($event, parcelMonthlyEvaporation)"></td>
                                    <td class="text-right"><strong>{{getTotalWaterUsageForParcel(parcel) | number:"1.1-1"}}</strong></td>
                                </tr>
                                <tr>
                                    <td><strong>Total</strong></td>
                                    <td class="text-right" *ngFor="let month of months; let i = index"><strong>{{getTotalWaterUsageForMonth(i+1) | number:"1.1-1"}}</strong></td>
                                    <td class="text-right"><strong>{{getTotalWaterUsageForAccount() | number:"1.1-1"}}</strong></td>
                                </tr>
                            </tbody>                            
                        </table>   
                        <p class="small">
                            <em>* Indicates OpenET usage data has been overridden</em>    
                        </p>                 
                    </div>
                    <ng-container *ngIf="isEditing">
                        <button class="btn btn-secondary btn-sm" style="float:right" (click)="cancelOverrideEtChanges()">Cancel</button>
                        <button class="btn btn-rio btn-sm mr-3" style="float:right" (click)="confirmSaveOverrideEtChanges()">Save</button>
                    </ng-container>
                </div>
            </div>
        </div>
    </div>
</div>